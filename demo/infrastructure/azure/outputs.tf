locals {
  config = {
    cert_manager = "${data.external.cert_manager.result}"
    externaldns  = "${data.external.externaldns.result}"
    gangway      = "${module.gangway.config}"

    ca = {
      key = "${module.ca.key}"
      crt = "${module.ca.crt}"
    }
  }
}

output "config" {
  value = "${jsonencode(local.config)}"
}

output "kubeconfig_command" {
  value = "cd infrastructure/azure/ && terraform output kubeconfig > $KUBECONFIG"
}

output "kubeconfig" {
  description = "kubectl config as generated by the module."
  value       = "${module.cluster.kubeconfig}"
}
